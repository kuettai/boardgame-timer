<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>BoardGame Timer</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Professional boardgame timer with dual modes and player management">
    <meta name="theme-color" content="#2196F3">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BGTimer">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Hide Safari UI elements when installed -->
    <meta name="format-detection" content="telephone=no">
    <style>
        /* Handle dynamic viewport changes from browser UI */
        :root {
            --vh: 1vh;
        }
        
        @media (display-mode: standalone) {
            body { 
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
            }
        }
        
        /* Ensure content is always scrollable on mobile */
        @media (max-width: 480px) {
            body {
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            #app {
                min-height: calc(var(--vh, 1vh) * 100);
            }
            
            .screen {
                min-height: calc(var(--vh, 1vh) * 100 - 2rem);
                padding-bottom: 4rem;
            }
        }
    </style>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%232196F3'/><circle cx='50' cy='50' r='30' fill='none' stroke='white' stroke-width='4'/><line x1='50' y1='50' x2='70' y2='50' stroke='white' stroke-width='3'/><line x1='50' y1='50' x2='50' y2='30' stroke='white' stroke-width='3'/></svg>">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%232196F3'/><circle cx='50' cy='50' r='30' fill='none' stroke='white' stroke-width='4'/></svg>">
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/setup.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/polish.css">
</head>
<body>
    <div id="app">
        <!-- Setup Screen -->
        <div id="setup-screen" class="screen active">
            <div class="header-controls">
                <h1>BoardGame Timer</h1>
                <div class="control-buttons">
                    <a href="https://github.com/kuettai/boardgame-timer/issues" target="_blank" class="github-link" title="Report an issue on GitHub">
                        üêõ
                    </a>
                    <button id="sound-toggle" class="control-btn" title="Toggle Sound Effects">
                        üîä
                    </button>
                    <button id="theme-toggle" class="control-btn" title="Toggle Dark/Light Theme">
                        üåô
                    </button>
                </div>
            </div>
            
            <!-- Mode Selection -->
            <div class="mode-selection">
                <label>
                    <input type="radio" name="mode" value="1" checked>
                    <span>Mode 1: Track Time</span>
                </label>
                <label>
                    <input type="radio" name="mode" value="2">
                    <span>Mode 2: Countdown</span>
                </label>
            </div>

            <!-- Template Selection (Mode 2 only) -->
            <div id="template-selection" class="template-selection" style="display: none;">
                <h3>Timer Settings</h3>
                <div class="template-options">
                    <label>
                        <input type="radio" name="template" value="quick" checked>
                        <span>Quick Game (30s turn, 15min round)</span>
                    </label>
                    <label>
                        <input type="radio" name="template" value="standard">
                        <span>Standard (60s turn, 30min round)</span>
                    </label>
                    <label>
                        <input type="radio" name="template" value="long">
                        <span>Long Game (90s turn, 60min round)</span>
                    </label>
                    <label>
                        <input type="radio" name="template" value="custom">
                        <span>Custom Timers</span>
                    </label>
                </div>
                
                <!-- Custom Timer Inputs -->
                <div id="custom-timers" class="custom-timers" style="display: none;">
                    <div class="timer-input-group">
                        <label for="turn-minutes">Turn Timer:</label>
                        <div class="time-inputs">
                            <input type="number" id="turn-minutes" min="0" max="59" value="0" class="time-input">
                            <span>min</span>
                            <input type="number" id="turn-seconds" min="0" max="59" value="15" class="time-input">
                            <span>sec</span>
                        </div>
                    </div>
                    <div class="timer-input-group">
                        <label for="round-minutes">Round Timer:</label>
                        <div class="time-inputs">
                            <input type="number" id="round-minutes" min="1" max="180" value="30" class="time-input">
                            <span>min</span>
                            <input type="number" id="round-seconds" min="0" max="59" value="0" class="time-input">
                            <span>sec</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Player Setup -->
            <div class="player-setup">
                <h2>Players (<span id="player-count">2</span>/8)</h2>
                <div id="players-list"></div>
                <button id="add-player" class="btn-add">+ Add Player</button>
            </div>

            <button id="start-game" class="btn-primary">Start Game</button>
            
            <div class="footer-credit">
                Built by Amazon Q ‚Ä¢ Author: KT ‚Ä¢ 
                <a href="https://www.paypal.com/paypalme/kuettai" target="_blank" class="footer-coffee-link" title="Buy me a coffee">
                    ‚òï Coffee
                </a>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div id="timer-display">
                <div id="current-player"></div>
                <div id="timer-value">00:00</div>
                <div id="game-duration">Game: 00:00</div>
            </div>
            <div id="all-players"></div>
            
            <div class="turn-history-section">
                <button id="history-toggle" class="history-toggle">üìú Turn History</button>
                <div id="turn-history" class="turn-history collapsed">
                    <div class="history-header">Recent Turns</div>
                    <div id="history-list" class="history-list"></div>
                </div>
            </div>
            
            <div class="game-controls">
                <button id="pause-btn">Pause</button>
                <button id="end-game-btn">End Game</button>
            </div>
            <div class="keyboard-hints">
                <span>‚å®Ô∏è Space: Next ‚Ä¢ ESC: Pause</span>
            </div>
        </div>
    </div>

    <script src="js/timer-engine.js"></script>
    <script src="js/countdown-timer.js"></script>
    <script src="js/ui-effects.js"></script>
    <script src="js/storage-manager.js"></script>
    <script src="js/wake-lock.js"></script>
    <script src="js/theme-manager.js"></script>
    <script src="js/sound-manager.js"></script>
    <script src="js/haptic-manager.js"></script>
    <script src="js/keyboard-handler.js"></script>
    <script src="js/game-timer.js"></script>
    <script src="js/player-setup.js"></script>
    <script src="js/app.js"></script>
</body>
</html>